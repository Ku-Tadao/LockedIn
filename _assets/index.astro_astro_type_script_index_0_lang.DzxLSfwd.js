const O=document.getElementById("app-data"),Q=O?JSON.parse(O.dataset.payload||"{}"):{},B="https://api.deadlock-api.com",L={metaLoaded:!1,lbLoaded:!1,lbRegion:"Europe"},V=a=>(a||"").toString().toLowerCase().trim(),y=a=>String(a??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;");function j(a){document.documentElement.setAttribute("data-theme",a),localStorage.setItem("li-theme",a);const e=document.getElementById("themeToggle");e&&(e.textContent=a==="dark"?"Light Mode":"Dark Mode")}function X(){const a=localStorage.getItem("li-theme");if(a){j(a);return}j(window.matchMedia?.("(prefers-color-scheme:dark)").matches?"dark":"light")}function Y(a){document.querySelectorAll(".nav-link").forEach(e=>e.classList.toggle("active",e.dataset.section===a))}function q(a){document.querySelectorAll("section.content").forEach(n=>{n.style.display="none"});const e=document.getElementById(a);e&&(e.style.display="",Y(a)),a==="stats"&&!L.metaLoaded&&(L.metaLoaded=!0,H()),a==="leaderboard"&&!L.lbLoaded&&(L.lbLoaded=!0,U(L.lbRegion))}function Z(a){const e=V(a);document.querySelectorAll(".hero-card").forEach(n=>{const o=n.dataset.heroName||"",s=n.dataset.heroType||"";n.style.display=!e||o.includes(e)||s.includes(e)?"":"none"})}function R(a){return Q.heroes?.find(e=>String(e.id)===String(a))}function F(a){const e=R(a);if(!e)return;const n=document.getElementById("heroModal");document.getElementById("modalHeroName").textContent="";const o=document.getElementById("modalHeroDetails");o.innerHTML="",n.classList.remove("hidden"),n.setAttribute("aria-hidden","false");const s="var(--"+(e.hero_type||"brand")+")";let t="";const r=e.images?.icon_hero_card_webp||e.images?.icon_hero_card||"";t+='<div class="hd-header">',t+='<img class="hd-portrait" src="'+r+'" alt="'+y(e.name)+'" />',t+='<div class="hd-info">',t+='<h2 class="hd-name">'+y(e.name)+"</h2>",t+='<span class="hd-type-pill '+(e.hero_type||"")+'">'+y(e.hero_type||"Unknown")+"</span>";const d=e.description;if(d&&(typeof d=="object"?(d.role&&(t+='<p class="hd-desc"><strong>'+y(d.role)+"</strong></p>"),d.playstyle&&(t+='<p class="hd-desc">'+y(d.playstyle)+"</p>")):t+='<p class="hd-desc">'+y(d)+"</p>"),e.tags&&e.tags.length&&(t+='<div class="hd-tags">',e.tags.forEach(l=>{t+='<span class="hd-tag">'+y(l)+"</span>"}),t+="</div>"),t+="</div></div>",e.complexity){t+='<div class="hd-stats-section"><div class="hd-stats-bar"><h4>Complexity</h4></div>',t+='<div style="display:flex;gap:4px;margin-bottom:1rem">';for(let l=1;l<=4;l++){const m=l<=e.complexity;t+='<span style="width:24px;height:8px;border-radius:4px;background:'+(m?s:"var(--surface-strong)")+'"></span>'}t+="</div></div>"}const p=l=>l!=null&&typeof l=="object"&&"value"in l?l.value:l;if(e.starting_stats){const l=e.starting_stats;t+='<div class="hd-stats-section"><div class="hd-stats-bar"><h4>Starting Stats</h4></div>',t+='<div class="hd-stats-grid">',[["Max Health",p(l.max_health)],["Health Regen",p(l.base_health_regen??l.health_regen)],["Bullet Armor",(()=>{const u=p(l.bullet_armor_damage_reduction??l.bullet_armor);return u&&u!==0&&u!=="0"?u+"%":null})()],["Spirit Armor",(()=>{const u=p(l.tech_armor_damage_reduction??l.spirit_armor);return u&&u!==0&&u!=="0"?u+"%":null})()],["Move Speed",p(l.max_move_speed??l.move_speed)],["Sprint Speed",p(l.sprint_speed)],["Stamina",p(l.stamina)],["Light Melee",p(l.light_melee_damage)],["Heavy Melee",p(l.heavy_melee_damage)],["Crit Multiplier",p(l.crit_damage_received_scale)]].filter(([,u])=>u!=null&&u!==""&&u!==0&&u!=="0").forEach(([u,h])=>{t+='<div class="hd-stat-card"><div class="hd-stat-value" style="color:'+s+'">'+y(String(h))+"</div>",t+='<div class="hd-stat-label">'+y(u)+"</div></div>"}),t+="</div></div>"}const c=e.shop_stat_display?.weapon_stats_display;if(c){if(t+='<div class="hd-stats-section"><div class="hd-stats-bar"><h4>Weapon</h4></div>',t+='<div class="hd-stats-grid">',c.weapon_attributes&&c.weapon_attributes.length){const l={EWeaponAttribute_RapidFire:"Rapid Fire",EWeaponAttribute_MediumRange:"Medium Range",EWeaponAttribute_LongRange:"Long Range",EWeaponAttribute_ShortRange:"Short Range",EWeaponAttribute_SemiAutomatic:"Semi-Auto",EWeaponAttribute_FullAutomatic:"Full Auto",EWeaponAttribute_BurstFire:"Burst Fire"};c.weapon_attributes.forEach(m=>{t+='<div class="hd-stat-card"><div class="hd-stat-value" style="color:'+s+'">'+y(l[m]||m.replace(/EWeaponAttribute_/g,"").replace(/_/g," "))+"</div>",t+='<div class="hd-stat-label">Weapon Type</div></div>'})}(c.weapon_image_webp||c.weapon_image)&&(t+='<div style="grid-column:1/-1;text-align:center;padding:.5rem"><img src="'+(c.weapon_image_webp||c.weapon_image)+'" alt="Weapon" style="max-width:200px;height:auto;filter:drop-shadow(0 2px 8px rgba(0,0,0,.3))" loading="lazy"/></div>'),t+="</div></div>"}if(e.items&&typeof e.items=="object"){const l=Object.keys(e.items).filter(m=>m.startsWith("signature"));l.length&&(t+='<div class="hd-abilities-section"><h4>Abilities</h4>',t+='<div id="abilities-container">',l.sort().forEach(()=>{t+='<div class="ability-box ability-skeleton"><div class="ability-header"><div class="skeleton-circle"></div><div class="skeleton-lines"><div class="skeleton-line"></div><div class="skeleton-line short"></div></div></div></div>'}),t+="</div></div>")}if(o.innerHTML=t,e.items&&typeof e.items=="object"){const l=Object.keys(e.items).filter(m=>m.startsWith("signature")).sort();l.length&&ee(e,l)}}let W=null;async function ee(a,e){const n=document.getElementById("abilities-container");if(n)try{if(!W){const r=await fetch("https://assets.deadlock-api.com/v2/items");if(!r.ok)throw new Error("HTTP "+r.status);W=await r.json()}const o=W,s={};(Array.isArray(o)?o:[]).forEach(r=>{s[r.class_name]=r});let t="";e.forEach((r,d)=>{const p=a.items[r],c=s[p];if(!c){const v=S(p);t+='<div class="ability-box"><div class="ability-header"><span class="ability-name">'+y(v)+"</span></div></div>";return}const l=c.name||S(p),m=c.image_webp||c.image||"",u=c.properties?.AbilityCooldown?.value,h=c.properties?.AbilityDuration?.value,g=c.properties?.AbilityCastRange?.value,f=c.description;let i="";if(f&&typeof f=="object"){const v=c.tooltip_details;v&&v.info_sections&&v.info_sections.length&&v.info_sections[0].loc_string?i=v.info_sections[0].loc_string:i=f.desc||f.quip||""}else typeof f=="string"&&(i=f);const b=c.ability_type==="ultimate",E=c.upgrades||[];if(t+='<div class="ability-box'+(b?" ability-ultimate":"")+'">',t+='<div class="ability-header">',t+='<div class="ability-header-left">',m&&(t+='<img class="ability-image" src="'+m+'" alt="'+y(l)+'" loading="lazy"/>'),t+='<div class="ability-title-group">',t+='<span class="ability-name">'+y(l)+"</span>",t+='<span class="ability-slot'+(b?" ult":"")+'">'+(b?"Ultimate":"Ability "+(d+1))+"</span>",t+="</div></div>",t+='<div class="ability-stats">',u&&u!=="0"&&u!==0&&(t+='<span class="ability-stat cd" title="Cooldown"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>'+u+"s</span>"),h&&h!=="0"&&h!==0&&(t+='<span class="ability-stat dur" title="Duration"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M12 8v4l2 2"/></svg>'+h+"s</span>"),g&&g!=="0"&&g!==0&&g!=="0m"&&(t+='<span class="ability-stat rng" title="Cast Range"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>'+g+"</span>"),t+="</div></div>",i){let v=i;v=v.replace(/<svg[^>]*>[\s\S]*?<\/svg>\s*/gi,""),v=v.replace(/\{g:citadel_binding:'([^']*)'\}/g,"[$1]"),v=v.replace(/<span class="inline-attribute-label[^"]*"[^>]*>/gi,""),v=v.replace(/\{s:sign\}/gi,"+"),v=v.replace(/\n+/g," ").replace(/\s{2,}/g," ").trim(),v&&(t+='<div class="ability-details"><div class="ability-desc">'+v+"</div></div>")}E.length&&(t+='<div class="ability-upgrades">',E.forEach((v,I)=>{if(!v.property_upgrades||!v.property_upgrades.length)return;const P=I+1,$=v.property_upgrades.map(z=>{const G=S(z.name||""),k=z.bonus;return(typeof k=="number"&&k>0||typeof k=="string"&&!k.startsWith("-")&&!k.startsWith("+")?"+":"")+k+" "+G}).join(", ");t+='<div class="ability-tier"><span class="tier-badge">T'+P+'</span><span class="tier-text">'+y($)+"</span></div>"}),t+="</div>"),t+="</div>"}),n.innerHTML=t}catch(o){console.warn("Failed to fetch ability details:",o);let s="";e.forEach(t=>{const r=S(a.items[t]);s+='<div class="ability-box"><div class="ability-header"><span class="ability-name">'+y(r)+"</span></div></div>"}),n.innerHTML=s}}function S(a){return String(a||"").replace(/^(ability_|citadel_ability_)/i,"").replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function M(){const a=document.getElementById("heroModal");a.classList.add("hidden"),a.setAttribute("aria-hidden","true")}function A(a){const e=document.getElementById("playerModal");if(!e)return;e.classList.remove("hidden");const n=document.getElementById("playerInput");n&&a?(n.value=a,T()):n&&!a&&n.focus()}function x(){const a=document.getElementById("playerModal");if(!a)return;a.classList.add("hidden");const e=document.getElementById("playerSearchResults"),n=document.getElementById("playerProfile");e&&(e.innerHTML=""),n&&(n.innerHTML="",n.classList.add("hidden"))}function N(){const a=document.getElementById("ovSearch");if(!a)return;const e=a.value.trim();e&&A(e)}async function T(){const a=document.getElementById("playerInput"),e=document.getElementById("playerSearchResults"),n=document.getElementById("playerProfile");if(!a||!e)return;const o=a.value.trim();if(!o){e.innerHTML='<div class="status">Enter a Steam username.</div>';return}e.innerHTML='<div class="status" style="animation:pulse 1.5s infinite">Searching...</div>',e.classList.remove("hidden"),n&&n.classList.add("hidden");try{const s=await fetch(B+"/v1/players/steam-search?username="+encodeURIComponent(o));if(!s.ok)throw new Error("HTTP "+s.status);const t=await s.json();if(!t||!t.length){e.innerHTML='<div class="status">No players found for "'+y(o)+'".</div>';return}e.innerHTML='<div class="search-results-header"><h3>'+t.length+" player"+(t.length!==1?"s":"")+' found</h3></div><div class="player-results-grid">'+t.slice(0,20).map(r=>'<div class="player-result-card" data-pid="'+y(r.account_id||r.steam_id)+'"><img class="player-result-avatar" src="'+(r.avatar_url||r.avatar||"")+`" alt="" loading="lazy" onerror="this.style.display='none'" /><div class="player-result-info"><h4>`+y(r.persona_name||r.name||"Unknown")+"</h4><p>"+y(r.account_id||r.steam_id||"")+"</p></div></div>").join("")+"</div>",e.querySelectorAll(".player-result-card").forEach(r=>r.addEventListener("click",()=>J(r.dataset.pid)))}catch{e.innerHTML='<div class="status">Search error. Please try again.</div>'}}async function J(a){const e=document.getElementById("playerSearchResults"),n=document.getElementById("playerProfile");if(n){n.classList.remove("hidden"),n.innerHTML='<div class="status" style="animation:pulse 1.5s infinite">Loading profile...</div>',e&&e.classList.add("hidden");try{const[o,s]=await Promise.allSettled([fetch(B+"/v1/players/"+encodeURIComponent(a)+"/match-history?limit=20"),fetch(B+"/v1/players/"+encodeURIComponent(a)+"/mmr-history")]),t=o.status==="fulfilled"&&o.value.ok?await o.value.json():null,r=s.status==="fulfilled"&&s.value.ok?await s.value.json():null;let d='<button type="button" class="btn btn-ghost btn-sm back-to-search" id="backBtn">← Back to results</button>';if(d+='<div class="player-profile-header">',d+='<div class="player-profile-info"><h3>Player '+y(a)+"</h3>",r&&r.length){const p=r[r.length-1];p.badge_level!=null&&(d+="<p>Current Badge Level: <strong>"+p.badge_level+"</strong></p>")}if(d+="</div></div>",t&&t.length){let p=0,c=0;t.forEach(h=>{h.match_result==="Win"||h.player_team_won?p++:c++});const l=t.length>0?p/t.length*100:0;d+='<h4 class="sub-title">Recent Matches ('+t.length+")</h4>",d+='<div class="donut-container">'+te(l)+'<div class="donut-stats-side"><div class="ds-row"><span class="ds-label">Matches</span><span class="ds-value">'+t.length+'</span></div><div class="ds-row"><span class="ds-label">Wins</span><span class="ds-value" style="color:var(--accent)">'+p+'</span></div><div class="ds-row"><span class="ds-label">Losses</span><span class="ds-value" style="color:var(--brawler)">'+c+"</span></div></div></div>";const m={};t.forEach(h=>{const g=h.hero_id;g&&(m[g]||(m[g]={count:0,wins:0}),m[g].count++,(h.match_result==="Win"||h.player_team_won)&&m[g].wins++)});const u=Object.entries(m).sort((h,g)=>g[1].count-h[1].count).slice(0,8);if(u.length){const h=u[0][1].count;d+='<h4 class="sub-title">Most Played Heroes</h4><div class="hero-time-list">',u.forEach(([g,f])=>{const i=R(g),b=i?.images?.icon_image_small_webp||i?.images?.icon_image_small||"",E=i?.name||"Hero #"+g,v=h>0?f.count/h*100:0,I=f.count>0?f.wins/f.count*100:0,P=I>=50?"var(--accent)":"var(--brawler)";d+='<div class="hero-time-row">'+(b?'<img src="'+b+'" alt="" loading="lazy"/>':"<div></div>")+'<div><span class="htb-name">'+y(E)+'</span><div class="htb-bar"><div class="htb-bar-fill" style="width:'+v.toFixed(1)+'%"></div></div></div><span class="hero-time-stats"><span style="color:'+P+'">'+I.toFixed(0)+"%</span> · "+f.count+" games</span></div>"}),d+="</div>"}}else d+='<div class="status">No match history available or profile is private.</div>';n.innerHTML=d,document.getElementById("backBtn")?.addEventListener("click",D)}catch{n.innerHTML='<button type="button" class="btn btn-ghost btn-sm back-to-search" id="backBtn">← Back</button><div class="status">Error loading profile.</div>',document.getElementById("backBtn")?.addEventListener("click",D)}}}function D(){const a=document.getElementById("playerSearchResults"),e=document.getElementById("playerProfile");a&&a.classList.remove("hidden"),e&&e.classList.add("hidden")}function te(a){const n=a/100*251.2,o=a>=50?"var(--accent)":"var(--brawler)";return'<div class="donut-chart"><svg viewBox="0 0 90 90"><circle class="donut-ring" cx="45" cy="45" r="40"/><circle class="donut-segment" cx="45" cy="45" r="40" stroke="'+o+'" stroke-dasharray="'+n.toFixed(1)+" "+251.2+'"/></svg><div class="donut-label"><span class="donut-value" style="color:'+o+'">'+a.toFixed(1)+'%</span><span class="donut-desc">Win Rate</span></div></div>'}let _="winrate",w="desc",C=null;async function H(){const a=document.getElementById("metaStatus"),e=document.getElementById("metaBody");if(!e)return;a&&(a.textContent="Loading hero stats..."),e.innerHTML='<tr><td colspan="8"><div class="meta-empty" style="animation:pulse 1.5s infinite"><p>Loading...</p></div></td></tr>';const n=document.getElementById("metaMinBadge")?.value||"0",o=document.getElementById("metaHeroType")?.value||"";let s=B+"/v1/analytics/hero-stats?min_badge_level="+n;try{const t=await fetch(s);if(!t.ok)throw new Error("HTTP "+t.status);const r=await t.json();if(!r||!r.length){e.innerHTML='<tr><td colspan="8"><div class="meta-empty"><p>No stats available.</p></div></td></tr>',a&&(a.textContent="No data found");return}const d=r.reduce((c,l)=>c+(l.matches||0),0);let p=r.map(c=>{const l=R(c.hero_id),m=c.matches||1;return{...c,hero:l,hero_type:l?.hero_type||"",win_rate:c.wins/m,pick_rate:d>0?m/d:0,avg_kills:(c.total_kills||0)/m,avg_deaths:(c.total_deaths||0)/m,avg_assists:(c.total_assists||0)/m}});o&&(p=p.filter(c=>c.hero_type===o)),C=p,_="winrate",w="desc",K(),a&&(a.textContent="Showing "+p.length+" heroes")}catch{e.innerHTML='<tr><td colspan="8"><div class="meta-empty"><p>Error loading stats. Try again.</p></div></td></tr>',a&&(a.textContent="Error loading stats")}}function K(){if(!C)return;const a=C.slice().sort((e,n)=>{let o,s;return _==="hero"?(o=(e.hero?.name||"").toLowerCase(),s=(n.hero?.name||"").toLowerCase(),w==="asc"?o.localeCompare(s):s.localeCompare(o)):_==="type"?(o=e.hero_type,s=n.hero_type,w==="asc"?o.localeCompare(s):s.localeCompare(o)):(_==="winrate"?(o=e.win_rate??e.winrate??0,s=n.win_rate??n.winrate??0):_==="pickrate"?(o=e.pick_rate??e.pickrate??0,s=n.pick_rate??n.pickrate??0):_==="matches"?(o=e.total_matches??e.matches??0,s=n.total_matches??n.matches??0):_==="kills"?(o=e.avg_kills??e.kills??0,s=n.avg_kills??n.kills??0):_==="deaths"?(o=e.avg_deaths??e.deaths??0,s=n.avg_deaths??n.deaths??0):_==="assists"?(o=e.avg_assists??e.assists??0,s=n.avg_assists??n.assists??0):(o=0,s=0),w==="asc"?o-s:s-o)});ae(a)}function ae(a){const e=document.getElementById("metaBody");if(!e)return;document.querySelectorAll("#metaTable thead th.sortable").forEach(s=>{const t=s.dataset.sort;s.classList.toggle("sort-active",t===_);const r=s.querySelector(".sort-arrow");if(r&&r.remove(),t===_){const d=document.createElement("span");d.className="sort-arrow",d.textContent=w==="asc"?" ▲":" ▼",s.appendChild(d)}});const n=Math.max(...a.map(s=>s.pick_rate??s.pickrate??0));let o="";a.forEach(s=>{const t=s.hero,r=t?.images?.icon_image_small_webp||t?.images?.icon_image_small||"",d=t?.name||"Hero #"+s.hero_id,p=s.hero_type||"unknown",c="var(--"+p+", var(--muted))",l=s.win_rate??s.winrate??0,m=s.pick_rate??s.pickrate??0,u=s.total_matches??s.matches??0,h=s.avg_kills??s.kills??0,g=s.avg_deaths??s.deaths??0,f=s.avg_assists??s.assists??0,i=(l*100).toFixed(1),b=(m*100).toFixed(2),E=n>0?m/n*100:0,v=l>=.5?"var(--accent)":"var(--brawler)";o+='<tr><td><div class="meta-hero-cell">'+(r?'<img class="meta-hero-portrait" src="'+r+'" alt="" loading="lazy"/>':"")+"<span>"+y(d)+'</span></div></td><td><span style="color:'+c+';font-weight:600;text-transform:capitalize;font-family:Chakra Petch,system-ui,sans-serif;font-size:.78rem">'+y(p)+'</span></td><td><div class="stat-bar-wrapper"><div class="stat-bar"><div class="stat-bar-fill winrate" style="width:'+i+"%;background:"+v+'"></div></div><span class="stat-value-label">'+i+'%</span></div></td><td><div class="stat-bar-wrapper"><div class="stat-bar"><div class="stat-bar-fill pickrate" style="width:'+E.toFixed(1)+'%"></div></div><span class="stat-value-label">'+b+"%</span></div></td><td>"+u.toLocaleString()+"</td><td>"+(typeof h=="number"?h.toFixed(1):h)+"</td><td>"+(typeof g=="number"?g.toFixed(1):g)+"</td><td>"+(typeof f=="number"?f.toFixed(1):f)+"</td></tr>"}),e.innerHTML=o||'<tr><td colspan="8"><div class="meta-empty"><p>No data.</p></div></td></tr>'}async function U(a){L.lbRegion=a;const e=document.getElementById("lbStatus"),n=document.getElementById("lbBody");if(n){e&&(e.textContent="Loading "+a+" leaderboard..."),n.innerHTML='<tr class="lb-placeholder"><td colspan="5"><div class="lb-empty"><div class="loading-dots"><span></span><span></span><span></span></div><p>Loading...</p></div></td></tr>',document.querySelectorAll(".region-btn").forEach(o=>o.classList.toggle("active",o.dataset.region===a));try{const o=await fetch(B+"/v1/leaderboard/"+encodeURIComponent(a));if(!o.ok)throw new Error("HTTP "+o.status);const s=await o.json(),t=Array.isArray(s)?s:s.entries||[];if(!t||!t.length){n.innerHTML='<tr><td colspan="5"><div class="lb-empty"><p>No leaderboard data available.</p></div></td></tr>',e&&(e.textContent="No data for "+a);return}let r="";t.slice(0,100).forEach(d=>{const p=d.rank??"-",c=typeof p=="number"?p:0,l=c===1?"top-1":c===2?"top-2":c===3?"top-3":"",m=d.account_name||"Unknown",u=d.badge_level??"-",h=d.ranked_rank!=null?d.ranked_rank:"-",g=d.ranked_subrank!=null?d.ranked_subrank:"",f=h!=="-"?h+(g?"."+g:""):"-";let i="-";d.top_hero_ids&&d.top_hero_ids.length&&(i=d.top_hero_ids.slice(0,3).map(b=>{const E=R(b);return E?y(E.name):"Hero #"+b}).join(", ")),r+='<tr><td class="lb-rank-cell '+l+'">'+p+'</td><td class="lb-player-cell"><span>'+y(m)+'</span></td><td class="lb-badge-cell">'+u+"</td><td>"+f+"</td><td>"+i+"</td></tr>"}),n.innerHTML=r,e&&(e.textContent="Showing top "+Math.min(t.length,100)+" players in "+a)}catch{n.innerHTML='<tr><td colspan="5"><div class="lb-empty"><p>Error loading leaderboard.</p></div></td></tr>',e&&(e.textContent="Error loading leaderboard")}}}function se(){document.querySelectorAll(".nav-link").forEach(i=>i.addEventListener("click",()=>q(i.dataset.section)));const a=document.getElementById("heroSearch");a&&a.addEventListener("input",i=>Z(i.target.value)),document.querySelectorAll(".hero-card").forEach(i=>i.addEventListener("click",()=>{i.dataset.heroId&&F(i.dataset.heroId)})),document.querySelectorAll(".featured-hero").forEach(i=>i.addEventListener("click",()=>{i.dataset.heroId&&F(i.dataset.heroId)})),document.querySelectorAll(".ql-card, .ov-stat").forEach(i=>i.addEventListener("click",()=>{i.dataset.section&&q(i.dataset.section)}));const e=document.getElementById("ovSearch");e&&e.addEventListener("keydown",i=>{i.key==="Enter"&&N()});const n=document.getElementById("ovSearchBtn");n&&n.addEventListener("click",N);const o=document.getElementById("playerInput");o&&o.addEventListener("keydown",i=>{i.key==="Enter"&&T()});const s=document.getElementById("playerSearchBtn");s&&s.addEventListener("click",T);const t=document.getElementById("closeModalBtn");t&&t.addEventListener("click",M);const r=document.getElementById("heroModal");r&&r.addEventListener("click",i=>{i.target===r&&M()});const d=document.getElementById("playerModalClose");d&&d.addEventListener("click",x);const p=document.getElementById("playerModal");p&&p.addEventListener("click",i=>{i.target===p&&x()}),document.addEventListener("keydown",i=>{i.key==="Escape"&&(M(),x())});const c=document.getElementById("themeToggle");c&&c.addEventListener("click",()=>j(document.documentElement.getAttribute("data-theme")==="dark"?"light":"dark"));const l=document.getElementById("productSwitcherBtn"),m=document.getElementById("productSwitcherDropdown");l&&m&&(l.addEventListener("click",i=>{i.stopPropagation(),m.classList.toggle("hidden")}),document.addEventListener("click",i=>{!m.contains(i.target)&&i.target!==l&&m.classList.add("hidden")}));const u=document.getElementById("headerSearchBtn"),h=document.getElementById("headerSearchInput"),g=document.getElementById("headerSearch");u&&u.addEventListener("click",()=>{if(!g.classList.contains("open")){g.classList.add("open"),h.focus();return}const i=h?h.value.trim():"";i&&A(i)}),h&&h.addEventListener("keydown",i=>{if(i.key==="Enter"){const b=h.value.trim();b&&A(b)}i.key==="Escape"&&(g.classList.remove("open"),h.value="")});const f=document.getElementById("metaRefresh");f&&f.addEventListener("click",H),document.querySelectorAll("#metaTable thead th.sortable").forEach(i=>{i.addEventListener("click",()=>{const b=i.dataset.sort;_===b?w=w==="desc"?"asc":"desc":(_=b,w="desc"),K()})}),["metaRegion","metaMinBadge","metaHeroType"].forEach(i=>{const b=document.getElementById(i);b&&b.addEventListener("change",()=>{C&&H()})}),document.querySelectorAll(".region-btn").forEach(i=>i.addEventListener("click",()=>U(i.dataset.region)))}document.addEventListener("DOMContentLoaded",()=>{"scrollRestoration"in history&&(history.scrollRestoration="manual"),window.scrollTo(0,0),X(),se(),q("overview")});window.LockedIn={showHeroDetails:F,closeModal:M,searchPlayer:T,loadProfile:J,backToSearch:D,fetchHeroStats:H,overviewSearch:N,openPlayerModal:A,closePlayerModal:x,fetchLeaderboard:U};
